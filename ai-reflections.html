<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Reflection Assistant | OnCallPrep</title>
    <meta name="description" content="Guidance on using AI tools appropriately for portfolio reflections, with RCGP-compliant disclaimers and best practices.">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/pages.css">
    <link rel="stylesheet" href="styles/content.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Fraunces:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo">
                <span class="logo-icon"></span>
                <span class="logo-text">OnCallPrep</span>
            </a>
            <ul class="nav-links">
                <li><a href="portfolio.html">Portfolio</a></li>
                <li><a href="sca.html">SCA</a></li>
                <li><a href="akt.html">AKT</a></li>
                <li><a href="hidden-curriculum.html">Hidden Curriculum</a></li>
                <li><a href="pricing.html">Pricing</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <div class="nav-auth">
                <a href="login.html" class="btn btn-ghost">Log in</a>
                <a href="signup.html" class="btn btn-primary">Start Free Trial</a>
            </div>
            <button class="mobile-menu-btn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header page-header-portfolio">
        <div class="container">
            <h1>AI Reflection Assistant</h1>
            <p>Using AI tools appropriately for portfolio reflections</p>
        </div>
    </section>

    <!-- Main Content -->
    <section class="content-page">
        <div class="container">
            <div class="content-intro">
                <p style="font-size: 1.125rem; line-height: 1.8; color: var(--color-gray-700);">
                    Artificial intelligence tools are increasingly available and can be helpful in drafting and refining portfolio reflections. However, it's essential to understand the boundaries of appropriate use, as outlined in <a href="https://www.rcgp.org.uk/mrcgp-exams/artificial-intelligence-exams-training" target="_blank" rel="noopener">RCGP guidance on AI in training and examinations</a> and <a href="https://www.rcgp.org.uk/mrcgp-exams/wpba/generative-artificial-intelligence" target="_blank" rel="noopener">RCGP guidance on generative AI in WPBA</a>.
                </p>
                
                <div class="info-box warning" style="margin-top: var(--space-lg);">
                    <div class="info-box-title">‚ö†Ô∏è Critical: Read This First</div>
                    <p style="margin-top: var(--space-sm); margin-bottom: 0;">
                        <strong>This tool is designed to assist with drafting and structuring reflections only.</strong> Your reflections must be based on <strong>real patient encounters</strong> that you have personally experienced. The reflective learning must be <strong>your own</strong>. AI should never be used to create artificial patient encounters or to generate reflections without genuine personal reflection. Educational Supervisors and ARCP panels may interrogate your reflections, and you must be able to discuss the underlying cases authentically.
                    </p>
                </div>
            </div>

            <!-- What is an AI Reflection Tool? -->
            <div class="content-section">
                <h2>What is an AI Reflection Assistant?</h2>
                <p>An AI reflection assistant is a tool designed to help you structure and refine your portfolio reflections. It works by:</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-lg); margin-top: var(--space-lg);">
                    <div style="padding: var(--space-lg); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">‚úçÔ∏è</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Structuring Your Thoughts</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">Helps organize your reflection using established frameworks (Gibbs, Rolfe, Borton, etc.)</p>
                    </div>
                    <div style="padding: var(--space-lg); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üîó</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Linking Competencies</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">Suggests relevant competency links based on your reflection content</p>
                    </div>
                    <div style="padding: var(--space-lg); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üìù</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Improving Clarity</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">Helps refine language and ensure your reflection demonstrates learning</p>
                    </div>
                    <div style="padding: var(--space-lg); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">‚úÖ</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Quality Checks</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">Reviews your reflection to ensure it meets RCGP requirements</p>
                    </div>
                </div>
            </div>

            <!-- How It Works -->
            <div class="content-section" style="background: linear-gradient(135deg, var(--color-primary-50) 0%, white 100%); border: 2px solid var(--color-primary-200);">
                <h2 style="color: var(--color-primary-700);">How an AI Reflection Tool Works</h2>
                <p style="font-size: 1.125rem; margin-bottom: var(--space-lg);">The process should follow these steps:</p>
                
                <div class="model-steps">
                    <div class="model-step">
                        <div class="step-number" style="background: var(--color-primary-500); color: white;">1</div>
                        <div class="step-content">
                            <strong style="color: var(--color-primary-700);">You Write Your Initial Reflection</strong>
                            <p style="margin-bottom: var(--space-sm);">Start by writing your reflection based on a <strong>real patient encounter</strong> you experienced. Include your thoughts, feelings, what happened, and what you learned. This is your authentic reflection.</p>
                            <div style="padding: var(--space-sm); background: white; border-radius: var(--radius-md); font-size: 0.9375rem; font-style: italic; color: var(--color-gray-700);">
                                <strong>Remember:</strong> The reflection must be based on a real case you personally managed.
                            </div>
                        </div>
                    </div>
                    <div class="model-step">
                        <div class="step-number" style="background: var(--color-primary-500); color: white;">2</div>
                        <div class="step-content">
                            <strong style="color: var(--color-primary-700);">AI Assists with Structure</strong>
                            <p style="margin-bottom: var(--space-sm);">The AI tool helps organize your reflection using established frameworks (like Gibbs Reflective Cycle or the Three-Link Rule). It may suggest improvements to clarity, suggest competency links, or help ensure all required elements are present.</p>
                        </div>
                    </div>
                    <div class="model-step">
                        <div class="step-number" style="background: var(--color-primary-500); color: white;">3</div>
                        <div class="step-content">
                            <strong style="color: var(--color-primary-700);">You Review and Refine</strong>
                            <p style="margin-bottom: var(--space-sm);">You review the AI's suggestions and decide what to incorporate. The final reflection must remain <strong>your own work</strong> - your thoughts, your learning, your insights. The AI is a drafting aid, not the author.</p>
                        </div>
                    </div>
                    <div class="model-step">
                        <div class="step-number" style="background: var(--color-primary-500); color: white;">4</div>
                        <div class="step-content">
                            <strong style="color: var(--color-primary-700);">You Submit Your Reflection</strong>
                            <p style="margin-bottom: var(--space-sm);">You submit the reflection to your e-portfolio. You must be prepared to discuss the underlying case with your Educational Supervisor or ARCP panel if asked.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RCGP Guidance -->
            <div class="content-section">
                <h2>RCGP Guidance on AI Use in Portfolio Reflections</h2>
                <p>According to the <a href="https://www.rcgp.org.uk/mrcgp-exams/artificial-intelligence-exams-training" target="_blank" rel="noopener">RCGP statement on AI in training and examinations</a>, the following principles apply:</p>
                
                <div style="padding: var(--space-xl); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200); margin-top: var(--space-lg);">
                    <h3 style="color: var(--color-primary-700); margin-bottom: var(--space-md);">‚úÖ Appropriate Use of AI</h3>
                    <ul style="margin-bottom: var(--space-md);">
                        <li><strong>Drafting assistance:</strong> AI can help with the drafting process, structuring your reflection, and improving clarity</li>
                        <li><strong>Competency linking:</strong> AI can suggest relevant competency links based on your reflection content</li>
                        <li><strong>Language refinement:</strong> AI can help improve the clarity and professionalism of your writing</li>
                        <li><strong>Framework application:</strong> AI can help you apply reflection frameworks (Gibbs, Rolfe, Borton) to your content</li>
                    </ul>
                    <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                        <strong>Key principle:</strong> The effective, critical use of AI technology will be a skill all GPs need. Using AI as a drafting tool is acceptable, provided the underlying reflection is your own.
                    </p>
                </div>

                <div style="padding: var(--space-xl); background: var(--color-error-50); border-radius: var(--radius-xl); border: 2px solid var(--color-error-200); margin-top: var(--space-lg);">
                    <h3 style="color: var(--color-error-700); margin-bottom: var(--space-md);">‚ùå Inappropriate Use of AI</h3>
                    <ul style="margin-bottom: var(--space-md);">
                        <li><strong>Creating artificial patient encounters:</strong> Never use AI to create fictional patient cases or encounters</li>
                        <li><strong>Mechanistic cut-and-paste:</strong> Don't use AI to generate entire reflections without genuine personal reflection</li>
                        <li><strong>Clinical diagnosis or management:</strong> Never use generic AI products (like ChatGPT) to generate diagnoses, interpret clinical information, or advise on clinical management - this is potentially dangerous</li>
                        <li><strong>Substituting your reflection:</strong> The reflective learning must be your own - AI should assist, not replace, your thinking</li>
                    </ul>
                    <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                        <strong>Critical:</strong> Using AI to create artificial patient encounters or taking a purely mechanistic approach risks raising questions of probity.
                    </p>
                </div>
            </div>

            <!-- Key Principles -->
            <div class="content-section">
                <h2>Key Principles for Using AI in Reflections</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-lg); margin-top: var(--space-lg);">
                    <div style="padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üéØ</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Real Cases Only</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                            All reflections must be based on <strong>real patient encounters</strong> that you personally experienced. Just as MSFs and PSQs must be based on feedback from real colleagues and real patients, learning logs must be based on real cases.
                        </p>
                    </div>
                    <div style="padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üß†</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Your Reflection</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                            The <strong>reflective learning must be your own</strong>. AI can help with drafting and structure, but the insights, learning, and analysis must come from you. You must be able to discuss your reflection authentically.
                        </p>
                    </div>
                    <div style="padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üîç</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Be Prepared to Discuss</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                            Educational Supervisors and ARCP panels may <strong>interrogate your reflections</strong>, particularly if they have concerns about authenticity. You must be able to discuss the underlying case and your learning genuinely.
                        </p>
                    </div>
                    <div style="padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">üìö</div>
                        <h4 style="color: var(--color-primary-700); margin-bottom: var(--space-sm);">Coverage of Curriculum</h4>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                            Learning logs demonstrate coverage of capabilities across the GP curriculum. This requires <strong>real cases</strong> to ensure training has been extensive enough and to avoid probity issues.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Link to Reflection Guide -->
            <div class="content-section" style="background: linear-gradient(135deg, var(--color-primary-50) 0%, white 100%); border: 2px solid var(--color-primary-200); padding: var(--space-2xl); text-align: center;">
                <h2 style="color: var(--color-primary-700); margin-bottom: var(--space-md);">Learn How to Write Effective Reflections</h2>
                <p style="font-size: 1.125rem; line-height: 1.8; color: var(--color-gray-700); margin-bottom: var(--space-lg); max-width: 700px; margin-left: auto; margin-right: auto;">
                    Before using AI tools, it's essential to understand the fundamentals of reflective writing. Our comprehensive guide covers the Three-Link Rule, reflection frameworks, and best practices.
                </p>
                <a href="reflection-guide.html" class="btn btn-primary btn-lg">View Reflective Writing Guide</a>
            </div>

            <!-- Legal Disclaimer -->
            <div class="content-section">
                <h2>Important Legal and Professional Disclaimers</h2>
                
                <div class="info-box warning" style="margin-bottom: var(--space-lg);">
                    <div class="info-box-title">‚ö†Ô∏è RCGP Position on AI Use</div>
                    <p style="margin-top: var(--space-sm); margin-bottom: 0;">
                        The RCGP does not believe it is possible to mandate that GPs in training should never use AI when completing learning logs or other portfolio elements. However, the key issue is <strong>reflective learning</strong>. The RCGP emphasizes that:
                    </p>
                    <ul style="margin-top: var(--space-sm); margin-bottom: 0;">
                        <li>Reflections must be based on <strong>real patients</strong> and <strong>real cases</strong></li>
                        <li>The <strong>reflective learning must be your own</strong></li>
                        <li>AI can help with drafting, but not with creating artificial encounters</li>
                        <li>Educational Supervisors and ARCP panels may interrogate reflections if concerns arise</li>
                    </ul>
                </div>

                <div style="padding: var(--space-xl); background: var(--color-gray-50); border-radius: var(--radius-xl); border: 2px solid var(--color-gray-200);">
                    <h3 style="color: var(--color-gray-800); margin-bottom: var(--space-md);">Clinical Use of AI</h3>
                    <p style="margin-bottom: var(--space-md);">
                        <strong>Critical warning:</strong> GPs in training should <strong>not currently be using</strong> generic, commercially available AI products (such as ChatGPT) to:
                    </p>
                    <ul style="margin-bottom: var(--space-md);">
                        <li>Generate diagnoses</li>
                        <li>Interpret clinical information</li>
                        <li>Advise on clinical management</li>
                    </ul>
                    <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                        This is potentially dangerous with possible significant impacts on patient care and outcomes. The effective use of appropriate medical AI products is a developing skillset, but generic AI tools are not suitable for clinical decision-making.
                    </p>
                </div>

                <div style="padding: var(--space-xl); background: var(--color-primary-50); border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200); margin-top: var(--space-lg);">
                    <h3 style="color: var(--color-primary-700); margin-bottom: var(--space-md);">Differential Attainment Considerations</h3>
                    <p style="margin-bottom: var(--space-md);">
                        The RCGP recognizes potential impacts on differential attainment related to AI use:
                    </p>
                    <ul style="margin-bottom: var(--space-md);">
                        <li>Potential biases in AI training data and development</li>
                        <li>Language barriers - trainees whose first language is not English may have different experiences with AI tools</li>
                        <li>Time-saving benefits may vary based on language proficiency</li>
                    </ul>
                    <p style="margin: 0; font-size: 0.95rem; color: var(--color-gray-700);">
                        The RCGP will continue to monitor and review these issues. Support is available for all trainees regardless of background.
                    </p>
                </div>
            </div>

            <!-- References -->
            <div class="content-section">
                <h2>Official RCGP Guidance</h2>
                <p>For the complete official guidance, please refer to:</p>
                <ul style="margin-top: var(--space-md);">
                    <li><a href="https://www.rcgp.org.uk/mrcgp-exams/artificial-intelligence-exams-training" target="_blank" rel="noopener">RCGP Statement on the Use of Artificial Intelligence in Postgraduate Training, Examinations and Registration</a></li>
                    <li><a href="https://www.rcgp.org.uk/mrcgp-exams/wpba/generative-artificial-intelligence" target="_blank" rel="noopener">RCGP Guidance on Generative Artificial Intelligence in WPBA</a></li>
                </ul>
                <p style="margin-top: var(--space-md); font-size: 0.95rem; color: var(--color-gray-600);">
                    <strong>Note:</strong> RCGP guidance is subject to annual review and may be updated. Always check the RCGP website for the most current guidance.
                </p>
            </div>

            <!-- Final Reminder -->
            <div class="content-section" style="padding: var(--space-2xl); background: linear-gradient(135deg, var(--color-primary-600) 0%, var(--color-primary-800) 100%); color: white; border-radius: var(--radius-xl); text-align: center;">
                <h2 style="color: white; margin-bottom: var(--space-md);">Remember: Authenticity is Key</h2>
                <p style="font-size: 1.125rem; line-height: 1.8; color: rgba(255,255,255,0.95); max-width: 800px; margin: 0 auto;">
                    AI tools can be helpful assistants in structuring and refining your reflections, but they cannot replace genuine reflective learning. Your reflections must be based on real patient encounters, demonstrate your own learning, and be something you can discuss authentically with your Educational Supervisor or ARCP panel. Use AI wisely, but always maintain the integrity of your reflective practice.
                </p>
            </div>

            <!-- AI Reflection Tool -->
            <div class="content-section" id="ai-tool-section" style="background: linear-gradient(135deg, var(--color-primary-50) 0%, white 100%); border: 2px solid var(--color-primary-200); margin-top: var(--space-4xl);">
                <div class="info-box tip" style="margin-bottom: var(--space-lg); background: var(--color-primary-100); border-left: 4px solid var(--color-primary-500);">
                    <div class="info-box-title" style="color: var(--color-primary-700);">üìñ Please Read Before Using</div>
                    <p style="margin-top: var(--space-sm); margin-bottom: 0;">
                        By using this tool, you confirm that you have read and understood all the guidance, disclaimers, and RCGP requirements outlined above. This tool is a <strong>drafting aid only</strong> and must be used in accordance with RCGP guidance on AI use in portfolio reflections.
                    </p>
                </div>

                <h2 style="color: var(--color-primary-700);">AI Reflection Assistant Tool</h2>
                <p style="font-size: 1.125rem; margin-bottom: var(--space-lg);">
                    Enter your reflection below based on a <strong>real patient encounter</strong> you experienced. The AI will help structure it, suggest competency links, and provide feedback to improve clarity and demonstrate learning.
                </p>
                
                <div class="info-box warning" style="margin-bottom: var(--space-lg);">
                    <div class="info-box-title">‚ö†Ô∏è Important Reminder</div>
                    <p style="margin-top: var(--space-sm); margin-bottom: 0;">
                        This tool is a <strong>drafting aid only</strong>. Your reflection must be based on a real patient encounter, and the reflective learning must be your own. You must be able to discuss the underlying case authentically with your Educational Supervisor or ARCP panel.
                    </p>
                </div>
                
                <div style="margin-top: var(--space-lg);">
                    <label for="reflection-input" style="display: block; margin-bottom: var(--space-sm); font-weight: 600; color: var(--color-gray-800);">
                        Your Reflection (based on a real patient encounter):
                    </label>
                    <textarea 
                        id="reflection-input" 
                        rows="12" 
                        style="width: 100%; padding: var(--space-md); border: 2px solid var(--color-gray-300); border-radius: var(--radius-lg); font-family: inherit; font-size: 0.95rem; line-height: 1.6; resize: vertical;"
                        placeholder="Describe your patient encounter and your reflection. Include: what happened, your thoughts and feelings, what you learned, and how this will change your practice..."
                    ></textarea>
                    <div style="margin-top: var(--space-xs); font-size: 0.875rem; color: var(--color-gray-600);">
                        <span id="char-count">0</span> / 5000 characters
                    </div>
                    
                    <button 
                        id="analyze-btn" 
                        class="btn btn-primary btn-lg" 
                        style="margin-top: var(--space-md); width: 100%;"
                        onclick="analyzeReflection()"
                    >
                        Get AI Suggestions
                    </button>
                    
                    <div id="loading" style="display: none; margin-top: var(--space-lg); padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200); text-align: center;">
                        <div style="font-size: 2rem; margin-bottom: var(--space-sm);">‚è≥</div>
                        <p style="margin: 0; color: var(--color-gray-700);">Analyzing your reflection... This may take a few moments.</p>
                    </div>
                    
                    <div id="results" style="display: none; margin-top: var(--space-lg);">
                        <div style="padding: var(--space-lg); background: white; border-radius: var(--radius-xl); border: 2px solid var(--color-primary-200);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                <h3 style="color: var(--color-primary-700); margin: 0;">AI Suggestions</h3>
                                <button onclick="copyResults()" class="btn btn-outline" style="padding: var(--space-xs) var(--space-md); font-size: 0.875rem;">
                                    Copy Results
                                </button>
                            </div>
                            <div id="suggestions-content" style="white-space: pre-line; line-height: 1.8; color: var(--color-gray-800); padding: var(--space-md); background: var(--color-gray-50); border-radius: var(--radius-lg);"></div>
                            <div style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 1px solid var(--color-gray-200); font-size: 0.875rem; color: var(--color-gray-600);">
                                <strong>Remember:</strong> These are suggestions only. Review carefully and ensure the final reflection is your own authentic work based on a real patient encounter.
                            </div>
                        </div>
                    </div>

                    <div id="error" style="display: none; margin-top: var(--space-lg); padding: var(--space-lg); background: var(--color-error-50); border-radius: var(--radius-xl); border: 2px solid var(--color-error-200);">
                        <h4 style="color: var(--color-error-700); margin-bottom: var(--space-sm);">Error</h4>
                        <p id="error-message" style="margin: 0; color: var(--color-error-700);"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 OnCallPrep. All rights reserved.</p>
        </div>
    </footer>

    <script src="scripts/main.js"></script>
    <script>
        // Character counter
        const reflectionInput = document.getElementById('reflection-input');
        const charCount = document.getElementById('char-count');
        
        if (reflectionInput && charCount) {
            reflectionInput.addEventListener('input', function() {
                const count = this.value.length;
                charCount.textContent = count;
                
                if (count > 5000) {
                    charCount.style.color = 'var(--color-error-600)';
                } else {
                    charCount.style.color = 'var(--color-gray-600)';
                }
            });
        }

        // Analyze reflection function
        async function analyzeReflection() {
            const input = document.getElementById('reflection-input');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const error = document.getElementById('error');
            const suggestionsContent = document.getElementById('suggestions-content');
            const analyzeBtn = document.getElementById('analyze-btn');
            
            if (!input || !input.value.trim()) {
                alert('Please enter your reflection first. Remember, it must be based on a real patient encounter you experienced.');
                return;
            }
            
            if (input.value.length > 5000) {
                alert('Reflection is too long. Please limit to 5000 characters.');
                return;
            }
            
            // Hide previous results/errors
            results.style.display = 'none';
            error.style.display = 'none';
            
            // Show loading
            loading.style.display = 'block';
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'Processing...';
            
            try {
                const response = await fetch('/api/reflect', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ reflection: input.value.trim() })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Failed to analyze reflection');
                }
                
                // Display results
                suggestionsContent.textContent = data.suggestions;
                results.style.display = 'block';
                results.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                
            } catch (err) {
                console.error('Error:', err);
                const errorMessage = document.getElementById('error-message');
                if (errorMessage) {
                    errorMessage.textContent = err.message || 'Failed to analyze reflection. Please try again.';
                }
                error.style.display = 'block';
                error.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } finally {
                loading.style.display = 'none';
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'Get AI Suggestions';
            }
        }

        // Copy results function
        function copyResults() {
            const suggestionsContent = document.getElementById('suggestions-content');
            if (suggestionsContent) {
                const text = suggestionsContent.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    const btn = event.target;
                    const originalText = btn.textContent;
                    btn.textContent = 'Copied!';
                    btn.style.background = 'var(--color-success-500)';
                    btn.style.color = 'white';
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.style.background = '';
                        btn.style.color = '';
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    alert('Failed to copy. Please select and copy manually.');
                });
            }
        }
    </script>
</body>
</html>

